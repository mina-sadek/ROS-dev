total credit of the AMSpi goes to lipoja, from his project located at https://github.com/lipoja/AMSpi
